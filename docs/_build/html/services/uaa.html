

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>User Accounts and Authentication &mdash; PredixPy 0.0.9 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="PredixPy 0.0.9 documentation" href="../index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> PredixPy
          

          
          </a>

          
            
            
              <div class="version">
                0.0.9
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cookbook/index.html">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devguide/index.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/PredixDev/predixpy">Source Code</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PredixPy</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>User Accounts and Authentication</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/services/uaa.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="user-accounts-and-authentication">
<h1>User Accounts and Authentication<a class="headerlink" href="#user-accounts-and-authentication" title="Permalink to this headline">¶</a></h1>
<p>The User Accounts and Authentication Service, known as UAA, is an OAuth2
implementation common in Cloud Foundry deployments.  You can learn more about
it from the <a class="reference external" href="https://www.predix.io/services/service.html?id=1172">UAA</a> catalog page.</p>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">You will need UAA to work with most Predix services including Asset, Time
Series, and ACS.</p>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>Here is a simple demo to create a uaa instance, create a client, authenticate
as the client, and print out the scopes:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">predix.admin.app</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">predix</span><span class="o">.</span><span class="n">admin</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">Manifest</span><span class="p">()</span>
<span class="n">app</span><span class="o">.</span><span class="n">create_uaa</span><span class="p">(</span><span class="s1">&#39;admin-secret&#39;</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">create_client</span><span class="p">(</span><span class="s1">&#39;my-client&#39;</span><span class="p">,</span> <span class="s1">&#39;my-client-secret&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">predix.app</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">predix</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">Manifest</span><span class="p">()</span>
<span class="n">uaa</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">get_uaa</span><span class="p">()</span>
<span class="n">uaa</span><span class="o">.</span><span class="n">authenticate</span><span class="p">(</span><span class="s1">&#39;my-client&#39;</span><span class="p">,</span> <span class="s1">&#39;my-client-secret&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">uaa</span><span class="o">.</span><span class="n">get_scopes</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="section" id="authentication">
<h2>Authentication<a class="headerlink" href="#authentication" title="Permalink to this headline">¶</a></h2>
<p><em>Is the username and password provided correct?</em></p>
<p>If so, those credentials can be authenticated and a token generated for proving
that the identify is verified.  This token is used in any subsequent service
calls in the header of those requests.  The Predix Python SDK takes care of
this transparently for you.</p>
<p>The username and password can be provided by an actual end “user”, an
application that is a “client”, or the “admin” user managing your cloud foundry
space.</p>
</div>
<div class="section" id="expiration">
<h2>Expiration<a class="headerlink" href="#expiration" title="Permalink to this headline">¶</a></h2>
<p>The token is only valid for a period of time so the Predix Python SDK tries to
manage this and only requests a new token if you explicitly logout a session to
invalidate a token or if you reach the expiration period.</p>
</div>
<div class="section" id="authorization">
<h2>Authorization<a class="headerlink" href="#authorization" title="Permalink to this headline">¶</a></h2>
<p><em>That authenticated token, is it allowed to talk to this other service?</em></p>
<p>Cloud Foundry and UAA have a sophisticated system of managing scopes and
authorities for what a user or client are able to do.  Since most services only
support coarse grained permissions such as read/write the Predix Python SDK
manages the details with a <code class="docutils literal"><span class="pre">grant_client()</span></code> method for each service.  If any
options are meaningful they are generally exposed.</p>
</div>
<div class="section" id="module-predix.security.uaa">
<span id="api"></span><h2>API<a class="headerlink" href="#module-predix.security.uaa" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="predix.security.uaa.UserAccountAuthentication">
<em class="property">class </em><code class="descclassname">predix.security.uaa.</code><code class="descname">UserAccountAuthentication</code><a class="headerlink" href="#predix.security.uaa.UserAccountAuthentication" title="Permalink to this definition">¶</a></dt>
<dd><p>The UAA service manages user account authorization and access control for
Predix service calls through client credentials captured in a bearer token.</p>
<p>Useful documentation about interacting with API here:
<a class="reference external" href="https://docs.cloudfoundry.org/api/uaa">https://docs.cloudfoundry.org/api/uaa</a></p>
<dl class="method">
<dt id="predix.security.uaa.UserAccountAuthentication.add_client_to_manifest">
<code class="descname">add_client_to_manifest</code><span class="sig-paren">(</span><em>client_id</em>, <em>client_secret</em>, <em>manifest</em><span class="sig-paren">)</span><a class="headerlink" href="#predix.security.uaa.UserAccountAuthentication.add_client_to_manifest" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the given client / secret to the manifest for use in
the application.</p>
</dd></dl>

<dl class="method">
<dt id="predix.security.uaa.UserAccountAuthentication.authenticate">
<code class="descname">authenticate</code><span class="sig-paren">(</span><em>client_id</em>, <em>client_secret</em>, <em>use_cache=True</em><span class="sig-paren">)</span><a class="headerlink" href="#predix.security.uaa.UserAccountAuthentication.authenticate" title="Permalink to this definition">¶</a></dt>
<dd><p>Authenticate the given client against UAA.  The resulting token
will be cached for reuse.</p>
</dd></dl>

<dl class="method">
<dt id="predix.security.uaa.UserAccountAuthentication.create_client">
<code class="descname">create_client</code><span class="sig-paren">(</span><em>client_id</em>, <em>client_secret</em>, <em>manifest=None</em><span class="sig-paren">)</span><a class="headerlink" href="#predix.security.uaa.UserAccountAuthentication.create_client" title="Permalink to this definition">¶</a></dt>
<dd><p>Will create a new client for your application use.</p>
</dd></dl>

<dl class="method">
<dt id="predix.security.uaa.UserAccountAuthentication.get_authorization_headers">
<code class="descname">get_authorization_headers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#predix.security.uaa.UserAccountAuthentication.get_authorization_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the authorization headers with the bearer token needed for
making calls to Predix Services protected by UAA.</p>
</dd></dl>

<dl class="method">
<dt id="predix.security.uaa.UserAccountAuthentication.get_client">
<code class="descname">get_client</code><span class="sig-paren">(</span><em>client_id</em><span class="sig-paren">)</span><a class="headerlink" href="#predix.security.uaa.UserAccountAuthentication.get_client" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns details about a specific client by the client_id.</p>
</dd></dl>

<dl class="method">
<dt id="predix.security.uaa.UserAccountAuthentication.get_clients">
<code class="descname">get_clients</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#predix.security.uaa.UserAccountAuthentication.get_clients" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the clients stored in the instance of UAA.</p>
</dd></dl>

<dl class="method">
<dt id="predix.security.uaa.UserAccountAuthentication.get_scopes">
<code class="descname">get_scopes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#predix.security.uaa.UserAccountAuthentication.get_scopes" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the scopes for the authorized client.</p>
</dd></dl>

<dl class="method">
<dt id="predix.security.uaa.UserAccountAuthentication.get_token">
<code class="descname">get_token</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#predix.security.uaa.UserAccountAuthentication.get_token" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the bare access token for the authorized client.</p>
</dd></dl>

<dl class="method">
<dt id="predix.security.uaa.UserAccountAuthentication.get_userinfo">
<code class="descname">get_userinfo</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#predix.security.uaa.UserAccountAuthentication.get_userinfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve user info for currently authenticated user.</p>
</dd></dl>

<dl class="method">
<dt id="predix.security.uaa.UserAccountAuthentication.get_users">
<code class="descname">get_users</code><span class="sig-paren">(</span><em>filter=None</em>, <em>sortBy=None</em>, <em>sortOrder=None</em>, <em>startIndex=None</em>, <em>count=None</em><span class="sig-paren">)</span><a class="headerlink" href="#predix.security.uaa.UserAccountAuthentication.get_users" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns users in UAA.</p>
<p>See <a class="reference external" href="https://docs.cloudfoundry.org/api/uaa/#list63">https://docs.cloudfoundry.org/api/uaa/#list63</a></p>
</dd></dl>

<dl class="method">
<dt id="predix.security.uaa.UserAccountAuthentication.is_admin">
<code class="descname">is_admin</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#predix.security.uaa.UserAccountAuthentication.is_admin" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether user is authenticated as the admin.</p>
</dd></dl>

<dl class="method">
<dt id="predix.security.uaa.UserAccountAuthentication.is_expired_token">
<code class="descname">is_expired_token</code><span class="sig-paren">(</span><em>client</em><span class="sig-paren">)</span><a class="headerlink" href="#predix.security.uaa.UserAccountAuthentication.is_expired_token" title="Permalink to this definition">¶</a></dt>
<dd><p>For a given client will test whether or not the token
has expired.</p>
<p>This is for testing a client object and does not look up
from client_id.  You can use _get_client_from_cache() to
lookup a client from client_id.</p>
</dd></dl>

<dl class="method">
<dt id="predix.security.uaa.UserAccountAuthentication.update_client_grants">
<code class="descname">update_client_grants</code><span class="sig-paren">(</span><em>client_id</em>, <em>scope=[]</em>, <em>authorities=[]</em>, <em>replace=False</em><span class="sig-paren">)</span><a class="headerlink" href="#predix.security.uaa.UserAccountAuthentication.update_client_grants" title="Permalink to this definition">¶</a></dt>
<dd><p>Will extend the client with any additional scopes or
authorities.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-predix.admin.uaa">
<span id="administration"></span><h2>Administration<a class="headerlink" href="#module-predix.admin.uaa" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="predix.admin.uaa.UserAccountAuthentication">
<em class="property">class </em><code class="descclassname">predix.admin.uaa.</code><code class="descname">UserAccountAuthentication</code><span class="sig-paren">(</span><em>plan_name=None</em>, <em>name=None</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#predix.admin.uaa.UserAccountAuthentication" title="Permalink to this definition">¶</a></dt>
<dd><p>User Account and Authentication Serice (UAA) provides user management
for Cloud Foundry.</p>
<p>A few helpful notes:
- You must already be logged into a CF target environment
- There can only be 10 instances of UAA within an org</p>
<dl class="method">
<dt id="predix.admin.uaa.UserAccountAuthentication.add_client_to_manifest">
<code class="descname">add_client_to_manifest</code><span class="sig-paren">(</span><em>client_id</em>, <em>client_secret</em>, <em>manifest</em><span class="sig-paren">)</span><a class="headerlink" href="#predix.admin.uaa.UserAccountAuthentication.add_client_to_manifest" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the client credentials to the specified manifest.</p>
</dd></dl>

<dl class="method">
<dt id="predix.admin.uaa.UserAccountAuthentication.add_to_manifest">
<code class="descname">add_to_manifest</code><span class="sig-paren">(</span><em>manifest</em><span class="sig-paren">)</span><a class="headerlink" href="#predix.admin.uaa.UserAccountAuthentication.add_to_manifest" title="Permalink to this definition">¶</a></dt>
<dd><p>Add useful details to the manifest about this service
so that it can be used in an application.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>manifest</strong> – An predix.admin.app.Manifest object
instance that manages reading/writing manifest config
for a cloud foundry app.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="predix.admin.uaa.UserAccountAuthentication.authenticate">
<code class="descname">authenticate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#predix.admin.uaa.UserAccountAuthentication.authenticate" title="Permalink to this definition">¶</a></dt>
<dd><p>Authenticate into the UAA instance as the admin user.</p>
</dd></dl>

<dl class="method">
<dt id="predix.admin.uaa.UserAccountAuthentication.create">
<code class="descname">create</code><span class="sig-paren">(</span><em>secret</em><span class="sig-paren">)</span><a class="headerlink" href="#predix.admin.uaa.UserAccountAuthentication.create" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new instance of the UAA service.  Requires a
secret password for the ‘admin’ user account.</p>
</dd></dl>

<dl class="method">
<dt id="predix.admin.uaa.UserAccountAuthentication.create_client">
<code class="descname">create_client</code><span class="sig-paren">(</span><em>client_id</em>, <em>client_secret</em><span class="sig-paren">)</span><a class="headerlink" href="#predix.admin.uaa.UserAccountAuthentication.create_client" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new client for use by applications.</p>
</dd></dl>

<dl class="method">
<dt id="predix.admin.uaa.UserAccountAuthentication.exists">
<code class="descname">exists</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#predix.admin.uaa.UserAccountAuthentication.exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests whether this given service already exists.</p>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Jayson DeLancey.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.0.9',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>